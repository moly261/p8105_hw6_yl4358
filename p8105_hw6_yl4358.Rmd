---
title: "p8105_hw6_yl4358"
author: "YI LIU"
date: "11/21/2019"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(modelr)
library(mgcv)
knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d

theme_set(theme_minimal() + theme_bw() + theme(legend.position = "bottom"))
```

# Problem 1

```{r}
birthweight_df = 
  read_csv("./data/birthweight.csv") %>% 
  janitor::clean_names() %>% 
  mutate(
    babysex = factor(babysex, levels = c(1, 2), labels = c("male", "female"), ordered = TRUE),
    frace = factor(frace, levels = c(1,2,3,4,8,9), labels = c("white", "black","asian","puerto_rican","other","unknown"), ordered = TRUE),
    malform = factor(malform, levels = c(0,1), labels = c("absent", "present"), ordered = TRUE),
    mrace = factor(mrace, levels = c(1,2,3,4,9), labels = c("white", "black","asian","puerto_rican","other"), ordered = TRUE)
  ) %>% 
  drop_na()

my_fit = lm(bwt ~ blength + delwt + smoken, data = birthweight_df)
summary(my_fit)

```

  I choose baby's length at birth(`blength`), mother's weight at delivery(`delwt`) and average number of cigarettes(`smoken`) smoked per day during pregnancy as predictor variables. Because baby's birth weight is highly related with the mother's health status, I choose `delwt` and `smoken` which represents mother's health status during pregnancy. According to common sense, the taller the baby is , the heavier the baby is, thus I also choose `blength`.


```{r}
birthweight_df %>% 
  modelr::add_residuals(my_fit) %>% 
  modelr::add_predictions(my_fit) %>% 
  ggplot(aes(x = pred, y = resid)) + geom_point(alpha=.4 ) +
  stat_smooth(method = "lm")
```

According to the plot, the residuals of this model have an average about 0 and constant variance.